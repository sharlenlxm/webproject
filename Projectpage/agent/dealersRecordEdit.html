<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>经销商管理</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
		<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
		<link rel="stylesheet" href="./css/font.css">
		<link rel="stylesheet" href="./css/xadmin.css">
		<link rel="stylesheet" href="./css/style.css">
		<script type="text/javascript" src="./js/jquery-3.2.1.js"></script>
		<script type="text/javascript" src="./lib/layui/layui.js" charset="utf-8"></script>
		<script type="text/javascript" src="./js/xadmin.js"></script>
		<script type="text/javascript">
			$(function() {
				$.ajax({
					type: 'POST',
					async: true,
					url: ".hongsou/getProvince",
					success: function(data) {
						for(var i = 0; i < data.length; i++) {
							$("#province").append("<option value='" + data[i].ProvinceID + "'>" + data[i].ProvinceName + "</option>");
							$("#businessLicenseProvince").append("<option value='" + data[i].ProvinceID + "'>" + data[i].ProvinceName + "</option>");
						}
					}
				});
			})
		</script>
	</head>

	<body>
		<div class="x-body">
			<div class="layui-row">
				<form id="myFrom" class="layui-form layui-col-md12">
					<div class="grid-demo">
						<!--基本资料-->
						<blockquote class="layui-elem-quote"><i class="iconfont icon-wode"></i>修改经销商</blockquote>
						<%-- 	         checked="${data.level } == '二级' ? 'checked':''" --%>
						<input type="hidden" id="dealerNumber" name="dealerNumber" value="${data.operatorNumber }">

						<div class="layui-form-item">
							<label for="username" class="layui-form-label">
                  	<span class="x-red">* </span>渠道名称：
              </label>
							<div class="layui-input-inline">
								<input value="${data.operatorName }" type="text" id="dealerName" name="dealerName" required="" lay-verify="required" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item">
							<label for="username" class="layui-form-label">
                  	<span class="x-red">* </span>联系人：
              </label>
							<div class="layui-input-inline">
								<input type="text" id="linkman" name="linkman" value="${data.name }" required="" lay-verify="required" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item">
							<label for="username" class="layui-form-label">
                  	<span class="x-red">* </span>联系电话：
              </label>
							<div class="layui-input-inline">
								<input type="text" id="phone" name="phone" value="${data.tell }" required="" lay-verify="required" autocomplete="off" class="layui-input">
							</div>
						</div>

						<div class="layui-form-item">
							<label for="username" class="layui-form-label">
	                  	<span class="x-red">* </span>所在区域：
	              </label>
							<div class="layui-input-inline shengshiqu">
								<select id="province" name="province" lay-ignore>
									<option value="${data.province }">${data.provinceC }</option>
								</select>
								<select id="city" name="city" lay-ignore>
									<option value="${data.city }">${data.cityC }</option>
								</select>
								<select id="area" name="area" lay-ignore>
									<option value="${data.area }">${data.areaC }</option>
								</select>
							</div>
						</div>
						<div class="layui-form-item">
							<label for="username" class="layui-form-label">
                  	<span class="x-red">* </span>详细地址：
              </label>
							<div class="layui-input-inline">
								<input type="text" id="address" name="address" value="${data.aDDRESSC }" required="" lay-verify="required" autocomplete="off" class="layui-input">
							</div>
						</div>
					</div>

					<div class="layui-row formbtnb">
						<div class="grid-demo">
							<div class="layui-form-item">
								<label for="L_repass" class="layui-form-label">
				      </label>
								<button class="layui-btn formbtn" lay-filter="add" lay-submit="">提交</button>
								<input type="button" value="返回" onclick="closeNow()" class="layui-btn layui-btn-warm formbtn">
							</div>
						</div>
					</div>
			</div>
			</form>

		</div>

		<script>
			// 省市联动
			$("#province").change(function() {
				$("#city").empty();
				$("#area").empty();
				$("#city").append("<option value=''>请选择市</option>");
				$("#area").append("<option value=''>请选择区/县</option>");
				var pid = $("#province").val()
				$.ajax({
					type: 'POST',
					async: true,
					url: ".hongsou/getCity",
					data: {
						"provinceId": pid
					},
					success: function(data) {
						for(var i = 0; i < data.length; i++) {
							$("#city").append("<option value='" + data[i].CityID + "'>" + data[i].CityName + "</option>");
						}
						$.ajax({
							type: 'POST',
							url: ".hongsou/getArea",
							data: {
								"cityId": data[0].CityID
							},
							success: function(data) {
								for(var i = 0; i < data.length; i++) {
									$("#area").append("<option value='" + data[i].AreaID + "'>" + data[i].AreaName + "</option>");
								}
							}
						});

					}
				});
			});

			// 市区联动
			$("#city").change(function() {
				$("#area").empty();
				$("#area").append("<option value=''>请选择区/县</option>");
				var cid = $("#city").val()
				$.ajax({
					type: 'POST',
					async: true,
					url: ".hongsou/getArea",
					data: {
						"cityId": cid
					},
					success: function(data) {
						for(var i = 0; i < data.length; i++) {
							$("#area").append("<option value='" + data[i].AreaID + "'>" + data[i].AreaName + "</option>");
						}
					}
				});
			});

			// 省市联动
			$("#businessLicenseProvince").change(function() {
				$("#businessLicenseCity").empty();
				$("#businessLicenseCity").append("<option value=''>请选择市</option>");
				var pid = $("#businessLicenseProvince").val()
				$.ajax({
					type: 'POST',
					async: true,
					url: ".hongsou/getCity",
					data: {
						"provinceId": pid
					},
					success: function(data) {
						for(var i = 0; i < data.length; i++) {
							$("#businessLicenseCity").append("<option value='" + data[i].CityID + "'>" + data[i].CityName + "</option>");
						}
					}
				});
			});
		</script>

		<script>
			// 表单提交
			layui.use(['form', 'layer'], function() {
				$ = layui.jquery;
				var form = layui.form,
					layer = layui.layer;

				//监听提交
				form.on('submit(add)', function(data) {

					//发异步，把数据提交给后台
					$.ajax({
						type: "post",
						url: ".dealers/getDealersRecordEdit",
						async: true,
						data: data.field,
						success: function(data) {
							if(data.code == 0000) {
								layer.alert("修改成功", {
									icon: 6
								}, function() {
									// 获得frame索引
									var index = parent.layer.getFrameIndex(window.name);
									//关闭当前frame
									parent.layer.close(index);
								});

							} else if(data.code == 0001) {
								layer.alert(desc);
							}
						}
					});
					return false;
				});

			});

			// 取消关闭当前层
			function closeNow() {
				var index = parent.layer.getFrameIndex(window.name);
				parent.layer.close(index);
			}
		</script>
	</body>

</html>