<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Insert title here</title>
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="./css/font.css">
    <link rel="stylesheet" href="./css/xadmin.css">
    <link rel="stylesheet" href="../../public/css/style-baobiao.css">
    <script type="text/javascript" src="./js/jquery-3.2.1.js"></script>
    <script type="text/javascript" src="./lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="./js/xadmin.js"></script>
    <style type="text/css">
    .index-zs .layui-col-md5 {
        width: 20%;
        text-align: center;
    }

    .homelistitle {
        font-size: 1.2rem;
        margin-bottom: 10px;
        color: #999;
    }

    .homelistc:last-child {
        margin-bottom: 20px;
    }

    .homelistc {
        font-size: 1.6rem;
        font-weight: 600;
    }

    .homelistc span {
        display: block;
        font-size: 1.6rem;
        font-weight: 600;
    }

    .homelistc span i {
        font-style: normal;
        font-size: 1.6rem;
        font-weight: 600;
    }

    p {
        font-size: 16px;
    }
    </style>
</head>

<body>
    <div class="x-body" id="levA1" style="display:none">
        <blockquote class="layui-elem-quote">欢迎登陆服务商后台管理</blockquote>
    </div>
    <div class="x-body" id="levA" style="display:none">
        <blockquote class="layui-elem-quote">概览数据</blockquote>
        <div class="layui-row index-zs">
            <div class="layui-col-md5">
                <div class="homelist">
                    <p class="homelistitle">账户余额（元）</p>
                    <div class="homelistc">
                        <span><i id="balance">0</i>元</span>
                    </div>
                </div>
            </div>
            <div class="layui-col-md5">
                <div class="homelist">
                    <p class="homelistitle">提现中余额（元）</p>
                    <div class="homelistc">
                        <span><i id="cashing"></i>元</span>
                    </div>
                </div>
            </div>
            <div class="layui-col-md5">
                <div class="homelist">
                    <p class="homelistitle">已提现金额（元）</p>
                    <div class="homelistc">
                        <span><i id="cashed"></i>元</span>
                    </div>
                </div>
            </div>
            <div class="layui-col-md5">
                <div class="homelist">
                    <p class="homelistitle">已结算余额（元）</p>
                    <div class="homelistc">
                        <span><i id="settlementAmount"></i>元</span>
                    </div>
                </div>
            </div>
            <!-- <div class="layui-col-md5">
					<div class="homelist">
						<p class="homelistitle">未结算余额（元）</p>
						<div class="homelistc">
							<span><i id="">1000</i>元</span>
						</div>
					</div>
				</div> -->
        </div>
        <blockquote class="layui-elem-quote">
            <span style="margin-right: 30px;">商户数据</span>
            <!-- <button class="layui-btn layui-btn-xs" id="now">今天</button>
				<button class="layui-btn layui-btn-xs" id="yes">昨天</button> -->
        </blockquote>
        <div class="baobiao">
            <div class="baobiao-col-1" style="padding-left: 0;">
                <div class="baobiaoK">
                    <div class="baobiaolist" style="line-height:52px;font-size:16px">
                        商户数
                    </div>
                    <div style="line-height:50px;font-size:16px" id="shopCount">
                        0
                    </div>
                </div>
            </div>
            <!-- <div class="baobiao-col-1" style="padding-right: 0;">
                <div class="baobiaoK">
                    <div class="baobiaolist" style="line-height:52px;font-size:16px">
                        佣金
                    </div>
                    <div style="line-height:50px;font-size:16px" id="brokerage">
                        0元
                    </div>
                </div>
            </div> -->
            <div class="baobiao-col-2">
                <div class="baobiaoK">
                    <div class="baobiaolist">
                        <p class="baobiaolistitle">交易笔数</p>
                        <p class="baobiaolistct" style="font-size:16px"><span id="transactionNumber">0</span> 笔</p>
                    </div>
                    <div class="layui-col-md6 layui-col-sm6 layui-col-xs6 baobiaod">
                        <div class="baobiaodc dnsj">
                            <div></div>
                            <p style="font-size:16px"><span id="wTransactionNumber">0</span> 笔</p>
                        </div>
                    </div>
                    <div class="layui-col-md6 layui-col-sm6 layui-col-xs6 baobiaod">
                        <div class="baobiaodc wmsj">
                            <div></div>
                            <p style="font-size:16px"><span id="zTransactionNumber">0</span> 笔</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="baobiao-col-2">
                <div class="baobiaoK">
                    <div class="baobiaolist">
                        <p class="baobiaolistitle">交易金额</span>
                        </p>
                        <p class="baobiaolistct" style="font-size:16px"><span id="incomeMoney">0</span> 元</p>
                    </div>
                    <div class="layui-col-md6 layui-col-sm6 layui-col-xs6 baobiaod">
                        <div class="baobiaodc dnsj">
                            <div></div>
                            <p><span id="wIncomeMoney">0</span> 元</p>
                        </div>
                    </div>
                    <div class="layui-col-md6 layui-col-sm6 layui-col-xs6 baobiaod">
                        <div class="baobiaodc wmsj">
                            <div></div>
                            <p><span id="zIncomeMoney">0</span> 元</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="baobiao-col-2">
                <div class="baobiaoK">
                    <div class="baobiaolist">
                        <p class="baobiaolistitle">退款金额</span>
                        </p>
                        <p class="baobiaolistct" style="font-size:16px"><span id="refundMoney">0</span> 元</p>
                    </div>
                    <div class="layui-col-md6 layui-col-sm6 layui-col-xs6 baobiaod">
                        <div class="baobiaodc dnsj">
                            <div></div>
                            <p style="font-size:16px"><span id="wRefundMoney">0</span> 元</p>
                        </div>
                    </div>
                    <div class="layui-col-md6 layui-col-sm6 layui-col-xs6 baobiaod">
                        <div class="baobiaodc wmsj">
                            <div></div>
                            <p style="font-size:16px"><span id="zRefundMoney">0</span> 元</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="baobiao-col-2">
                <div class="baobiaoK">
                    <div class="baobiaolist">
                        <p class="baobiaolistitle">手续费</span>
                        </p>
                        <p class="baobiaolistct" style="font-size:16px"><span id="refundMoney">0</span> 元</p>
                    </div>
                    <div class="layui-col-md6 layui-col-sm6 layui-col-xs6 baobiaod">
                        <div class="baobiaodc dnsj">
                            <div></div>
                            <p style="font-size:16px"><span id="wRefundMoney">0</span> 元</p>
                        </div>
                    </div>
                    <div class="layui-col-md6 layui-col-sm6 layui-col-xs6 baobiaod">
                        <div class="baobiaodc wmsj">
                            <div></div>
                            <p style="font-size:16px"><span id="zRefundMoney">0</span> 元</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="layui-row layui-col-space30">
            <div class="layui-col-md5">
                <fieldset class="layui-elem-field layui-field-title">
                    <legend>账单列表</legend>
                </fieldset>
                <table class="layui-hide" id="LAY_table_SettlementRecords" lay-filter="Records"></table>
            </div>
            <div class="layui-col-md7">
                <fieldset class="layui-elem-field layui-field-title">
                    <legend>提现记录</legend>
                </fieldset>
                <table class="layui-hide" id="LAY_table_WithdrawalRecord" lay-filter="Record"></table>
            </div>
        </div>
    </div>
    <script src="../../common/config-agent.js"></script>
    <script src="../../common/utility.js"></script>
    <script>
    var userNumber = JSON.parse(sessionStorage.getItem('agentUser')).Number;
    var agentLevel = JSON.parse(sessionStorage.getItem('agentUser')).agentLevel;
    if (agentLevel != 'A') {
        $('#levA').hide()
        $('#levA1').show()
    } else {
        $('#levA1').hide()
        $('#levA').show()
    }
    layui.use(['table', 'table', 'laytpl', 'laydate', 'layer'], function() {
        var table = layui.table,
            form = layui.form,
            laydate = layui.laydate,
            laytpl = layui.laytpl,
            layer = layui.layer,
            $ = layui.jquery;

        //方法级渲染(结算记录)
        table.render({
            elem: '#LAY_table_SettlementRecords',
            url: CmsConfig.ServiceUrl.ApiRootUrl + CmsConfig.addressUrl.Agent.selectAgentBillList + '?agentNumber=' + userNumber,
            where: {
                "startTime": '',
                "endTime": '',
            },
            method: "post",
            height: 'full-270',
            response: {
                //res 即为原始返回的数据
                "statusCode": "1000", //解析接口状态

            },
            parseData: function(res) {
                //res 即为原始返回的数据
                return {
                    "code": res.code, //解析接口状态
                    "msg": res.msg, //解析提示文本
                    //"count": res.data.count, //解析数据长度
                    "data": res.data.agentBillList, //解析数据列表
                };
            },
            cols: [
                [{
                    field: 'inserttime',
                    title: '日期',
                    align: 'center',

                }, {
                    field: 'importExportAmount',
                    align: 'center',
                    title: '分润金额',
                    templet:function(data){
                        return '￥' + data.importExportAmount
                    }
                }, {
                    field: 'endTermBalance',
                    title: '变动后金额',
                    align: 'center',
                    templet:function(data){
                        return '￥' + data.endTermBalance
                    }
                }]
            ]
        });

        //方法级渲染(提现记录)
        table.render({
            elem: '#LAY_table_WithdrawalRecord',
            url: CmsConfig.ServiceUrl.ApiRootUrl + CmsConfig.addressUrl.Agent.getAgentWithdrawCash + '?agentNumber=' + userNumber,
            method: "post",
            height: 'full-270',
            response: {
                //res 即为原始返回的数据
                "statusCode": "1000", //解析接口状态

            },
            parseData: function(res) {
                //res 即为原始返回的数据
                if (res.code != 1000) {
                    return
                }
                return {
                    "code": res.code, //解析接口状态
                    "msg": res.msg, //解析提示文本
                    //"count": res.data.count, //解析数据长度
                    "data": res.data.data, //解析数据列表
                };
            },
            cols: [
                [{
                    field: 'updatetime',
                    title: '日期',
                    align: 'center'
                }, {
                    field: 'withdrawCashAmount',
                    align: 'center',
                    title: '金额',
                    templet:function(data){
                        return '￥' + data.withdrawCashAmount
                    }
                }, {
                    field: 'bankCardNo',
                    align: 'center',
                    title: '状态',
                    templet: function(data) {
                        if (data.orderType == 0) {
                            return '审核中'
                        }
                        if (data.orderType == 1) {
                            return '已审核'
                        }
                        if (data.orderType == -1) {
                            return '已拒绝'
                        }
                    }
                }]
            ]
        });

        function getAll() {

            CmsUtility.postAjaxCall(
                //系统设置
                CmsConfig.addressUrl.Agent.selectAgOverview, {
                    "agentNumber": userNumber,
                },
                function(data) {

                    console.log(data.data)
                    $('#balance').html(data.data.balance)
                    $('#cashing').html(data.data.cashing)
                    $('#settlementAmount').html(data.data.settlementAmount)
                    $('#cashed').html(data.data.cashed)
                }
            )
        }
        getAll()

        var myDate = new Date().toLocaleDateString().split('/')[0] + '-' + new Date().toLocaleDateString().split('/')[1] + '-' + new Date().toLocaleDateString().split('/')[2];
        console.log(myDate)

        function getShop() {
            console.log(myDate)
            var index = layer.load(2, { shade: [0.4, '#393D49'] })
            CmsUtility.postAjaxCall(
                //系统设置
                CmsConfig.addressUrl.Agent.selectMerchant, {
                    "agentNumber": userNumber,
                    "agentLevel": agentLevel,
                    "startTi	me": "",
                    "endtime": "",
                },
                function(data) {
                    layer.closeAll()
                    if (data.code == 1000) {


                        $('#shopCount').html(data.data.agShopStatisticsResult.shopCount)
                        $('#brokerage').html(data.data.agShopStatisticsResult.brokerage + '元')
                        $('#transactionNumber').html(data.data.agShopStatisticsResult.transactionNumber)
                        $('#wTransactionNumber').html(data.data.agShopStatisticsResult.wTransactionNumber)
                        $('#zTransactionNumber').html(data.data.agShopStatisticsResult.zTransactionNumber)
                        $('#incomeMoney').html(data.data.agShopStatisticsResult.transactionMoney)
                        $('#wIncomeMoney').html(data.data.agShopStatisticsResult.wTransactionMoney)

                        $('#zIncomeMoney').html(data.data.agShopStatisticsResult.zTransactionMoney)
                        $('#refundMoney').html(data.data.agShopStatisticsResult.refundMoney)
                        $('#wRefundMoney').html(data.data.agShopStatisticsResult.wRefundMoney)
                        $('#zRefundMoney').html(data.data.agShopStatisticsResult.zRefundMoney)
                    } else {
                        layer.msg(data.msg)

                    }
                },
                function(data) {
                    console.log('222')
                }
            )
        }
        getShop()
    });

    $('#now').click(function() {
        myDate = new Date().toLocaleDateString().split('/')[0] + '-' + new Date().toLocaleDateString().split('/')[1] + '-' + new Date().toLocaleDateString().split('/')[2];
        console.log(myDate)
        getShop()
    })
    $('#yes').click(function() {
        myDate = new Date(new Date().getTime() - 24 * 60 * 60 * 1000).toLocaleDateString().split('/')[0] + '-' + new Date(new Date().getTime() - 24 * 60 * 60 * 1000).toLocaleDateString().split('/')[1] + '-' + new Date(new Date().getTime() - 24 * 60 * 60 * 1000).toLocaleDateString().split('/')[2];
        console.log(myDate)
        getShop()
    })
    </script>
</body>

</html>