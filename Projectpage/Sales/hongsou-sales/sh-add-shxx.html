<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>注册商户</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link rel="stylesheet" href="./css/mui.min.css">
		<link rel="stylesheet" type="text/css" href="./css/mystyle.css?v=1" />
		<!--App自定义的css-->
		<link rel="stylesheet" type="text/css" href="./css/app.css" />
		<link href="./css/mui.picker.css" rel="stylesheet" />
		<link href="./css/mui.poppicker.css" rel="stylesheet" />
		<link href="./css/mui.dtpicker.css" rel="stylesheet" />
		<link href="${pageContext.request.contextPath}/configuration/css/iconfont.css" rel="stylesheet" />
		<script src="./js/zepto.min.js" type="text/javascript" charset="utf-8"></script>
		<style type="text/css">
			#iconfont {
				padding-top: 10px;
				line-height: 1;
			}
		</style>
		<script type="text/javascript">
			$(document).ready(function() {
				clear();
			});

			function clear() {
				var typelx = '${list[0].AccountType}';
				if(typelx == "A") {
					$("#Idexpirydate").val("")
				}
			}
		</script>
	</head>

	<body>
		<input type="hidden" id="QRCodeNumber" name="QRCodeNumber" value="${pd.QRCodeNumber }">
		<input type="hidden" id="UserNumber" name="UserNumber" value="${pd.UserNumber }">
		<input type="hidden" id="ShopNumber" name="ShopNumber" value="${pd.ShopNumber }">
		<input type="hidden" id="Source" name="Source" value="${pd.Source }">
		<header class="mui-bar mui-bar-nav">
			<!-- <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left" id="btngoback"></a> -->
			<i class="iconfont" id="Fanhui">&#xe630;</i>
			<h1 class="mui-title">商户信息</h1>
		</header>
		<div class="mui-content">
			<form class="mui-content-padded" style="margin: 5px;padding-bottom:40px;">
				<div class="mui-input-row">
					<h5>
					商户名称<sub>*</sub>
				</h5>
					<input type="text" id="ShopName" class="mui-input-clear" value="${list[0].ShopName}">
				</div>
				<!--个人-->
				<div class="mui-input-row">
					<h5>
					证件类型<sub>*</sub><span class="tips"></span>
				</h5>
					<div class="mui-input-row mui-radio idtype">
						<label class="jiesuanlx">个体</label>
						<c:if test="${empty list }">
							<input id="idtype2" name="idtype" type="radio" value="B" onclick="test(this)">
						</c:if>
						<c:if test="${not empty list }">
							<input id="idtype2" name="idtype" type="radio" value="B" onclick="test(this)" <c:if test="${list[0].AccountType eq 'B'}">checked="checked"</c:if>>
						</c:if>
					</div>
					<div class="mui-input-row mui-radio idtype">
						<label class="jiesuanlx">个人</label>
						<c:if test="${empty list }">
							<input id="idtype3" name="idtype" type="radio" value="A" onclick="test(this)" checked>
						</c:if>
						<c:if test="${not empty list }">
							<input id="idtype3" name="idtype" type="radio" value="A" onclick="test(this)" <c:if test="${list[0].AccountType eq 'A'}">checked="checked"</c:if>>
						</c:if>
					</div>
					<script type="text/javascript">
						function test(obj) {
							if(obj.id == "idtype2") {
								document.getElementById("BusinessName").style.display = "block";
								document.getElementById("zzyouxiaoqi").style.display = "block";

							} else if(obj.id == "idtype3") {
								document.getElementById("BusinessName").style.display = "none";
								document.getElementById("zzyouxiaoqi").style.display = "none";
							}
						}
					</script>
				</div>
				<c:if test="${list[0].AccountType eq 'B'}">
					<div class="mui-input-row" style="display: none;">
						<h5>
						个体工商户营业执照名称<sub>*</sub><span class="tips"></span>
					</h5>
						<input type="text" id="BusinessLicenseName" class="mui-input-clear" value="${list[0].BusinessLicenseName}">
					</div>
					<div class="mui-input-row" id="BusinessName">
						<h5>
						<em id="showcate">个体工商户营业执照</em>证件号码<sub>*</sub><span class="tips"></span>
					</h5>
						<input type="text" name="Idnumber1" id="Idnumber" class="mui-input-clear" value="${list[0].BusinessLicense}">
					</div>
				</c:if>
				<c:if test="${list[0].AccountType eq 'A'}">
					<div class="mui-input-row" style="display: none;">
						<h5>
						个体工商户营业执照名称<sub>*</sub><span class="tips"></span>
					</h5>
						<input type="text" id="BusinessLicenseName" class="mui-input-clear" value="${list[0].BusinessLicenseName}">
					</div>
					<div class="mui-input-row" id="BusinessName" style="display: none;">
						<h5>
						<em id="showcate">个体工商户营业执照</em>证件号码<sub>*</sub><span class="tips"></span>
					</h5>
						<input type="text" id="Idnumber" class="mui-input-clear" value="${list[0].BusinessLicense}">
					</div>
				</c:if>
				<c:if test="${ empty list[0].AccountType }">
					<div class="mui-input-row" style="display: none;">
						<h5>
						个体工商户营业执照名称<sub>*</sub><span class="tips"></span>
					</h5>
						<input type="text" id="BusinessLicenseName" class="mui-input-clear" value="${list[0].BusinessLicenseName}">
					</div>
					<div class="mui-input-row" id="BusinessName" style="display: none;">
						<h5>
						<em id="showcate">个体工商户营业执照</em>证件号码<sub>*</sub><span class="tips"></span>
					</h5>
						<input type="text" id="Idnumber" class="mui-input-clear" value="${list[0].BusinessLicense}">
					</div>
				</c:if>

				<div class="mui-input-row" id='zzyouxiaoqi' style="display: none;">
					<h5>
					<em >个体工商户营业执照</em>证件到期日<sub>*</sub><span class="tips">格式YYYYMMDD</span>
				</h5>
					<input type="text" id="Idexpirydate" class="mui-input-clear" value="${list[0].BusinessLicenseTime}" data-options='{"starttoday":1,"type":"date","beginDate":1,"endDate":"2099-11-31"}' placeholder="长期请填20991231 无有效期请填 19000101">
				</div>
				<div class="mui-input-row">
					<h5>
					法人姓名<sub>*</sub><span class="tips"></span>
				</h5>
					<input type="text" id="Contactname" class="mui-input-clear" value="${list[0].UserName}">
				</div>
				<div class="mui-input-row">
					<h5>
					法人身份证号<sub>*</sub><span class="tips"></span>
				</h5>
					<input type="text" id="Identitycard" class="mui-input-clear" value="${list[0].LegalPersonID}">
				</div>
				<div class="mui-input-row" id='fryouxiaoqi'>
					<h5>
					法人身份证到期日<sub>*</sub><span class="tips">(格式YYYYMMDD)</span>
				</h5>
					<input type="text" id="Identitycarddate" class="mui-input-clear" value="${list[0].LegalPersonDate}" data-options='{"starttoday":1,"type":"date","beginDate":1,"endDate":"2099-11-31"}' placeholder="长期请填20991231 无有效期请填 19000101">
				</div>

				<div class="mui-input-row">
					<h5>
					联系电话<sub>*</sub><span class="tips"></span>
				</h5>
					<input type="number" id="contacttel" class="mui-input-clear" value="${list[0].UserCell}">
					<c:if test="${pd.Source eq 1}">
						<style>
							.yanzheng {
								width: 100%;
							}
							
							.yanzheng input {
								width: 64%;
								float: left;
							}
							
							.yanzheng botton {
								background: rgb(47, 164, 234);
								color: #fff;
								width: 34%;
								float: right;
								border-radius: 5px;
								text-align: center;
								line-height: 40px;
								font-size: 14px;
							}
						</style>
						<div class="yanzheng">
							<input type="number" id="verificationCode" placeholder="输入验证码">
							<botton id="codebtn" type="button">获取验证码</botton>
						</div>
					</c:if>

				</div>
				<div class="mui-input-row">
					<h5>
					经营范围<sub>*</sub><span class="tips"></span>
				</h5>
					<input type="text" id='hangyeResult' class="mui-input-clear" value="${list[0].IndustryName}">
					<input type="hidden" id="IndustrySonType" value="${list[0].IndustryNumber }">
				</div>
				<div class="mui-input-row">
					<h5>
					商户所在地<sub>*</sub><span class="tips"></span>
				</h5>
					<input type="text" id='cityResult' value="${list[0].UserProCitAreName}">
					<input type="hidden" id='provinceID' value="${list[0].UserProvinceName}">
					<input type="hidden" id='cityID' value="${list[0].UserCityName}">
					<input type="hidden" id='districtID' value="${list[0].UserAreaName}">
				</div>
				<div class="mui-input-row">
					<h5>
					商户所在详细地址<sub>*</sub><span class="tips"></span>
				</h5>
					<input type="text" id="detailedaddress" class="mui-input-clear" value="${list[0].UserAddress}">
				</div>

			</form>
			<div id="caozuo" style=" text-align:center;">
				<i class="iconfont btngoback" id="btngoback"> &#xe622;</i>
				<!-- <a class="mui-btn mui-btn-primary nextstep" id="Fanhui" style="width: 150px;">返回</a>
			<a class="mui-btn mui-btn-primary nextstep" id="Submit" style="width: 150px;">下一步</a> -->
				<i class="iconfont Submit" id="Submit">&#xe621;</i>
			</div>
		</div>
	</body>
	<script src="./js/mui.min.js "></script>
	<script src="./js/mui.view.js "></script>
	<script src="./js/mui.datepicker.js"></script>
	<script src="./js/mui.picker.js"></script>
	<script src="./js/mui.poppicker.js"></script>
	<script src="./js/hangye.js" type="text/javascript" charset="utf-8"></script>
	<script>
		(function($, doc) {
			$.init();
			$.ready(function() {
				var flag = false;
				//创建遮罩蒙板
				var mask = mui.createMask(function() {
					//设置点击蒙板不会自动消失
					//但调用close方法关闭mask时，必须返回true
					return flag;
				});
				//导航返回事件
				document.getElementById("btngoback").addEventListener('click', function() {
					var QRCodeNumber = $("#QRCodeNumber")[0].value;
					window.location.href = '${pageContext.request.contextPath}/salesingup/goindexsale?QRCodeNumber=' + QRCodeNumber;
				});
				var Source = $("#Source")[0].value;
				//导航返回事件
				document.getElementById("Fanhui").addEventListener('click', function() {
					//来源 自注册：z0 连接进件：
					if(Source != "1") {
						var QRCodeNumber = $("#QRCodeNumber")[0].value;
						var UserNumber = $("#UserNumber")[0].value; //商户编号
						var ShopNumber = $("#ShopNumber")[0].value; //店铺编号
						window.location.href = '${pageContext.request.contextPath}/salesingup/goindexsale?UserNumber=' + UserNumber + '&ShopNumber=' + ShopNumber + '&QRCodeNumber=' + QRCodeNumber;
					}
				});
				if(Source != "1") {
					document.getElementById("codebtn").addEventListener('click', function() {
						//点击获取验证码事件
						var phoneReg = /^[1][3,4,5,7,8][0-9]{9}$/;
						var phone = $("#contacttel")[0].value;
						if(!phoneReg.test(phone)) {
							mui.alert('请输入正确的手机号码！');
							return;
						} else {
							// 时间倒计时
							var wait = 60;

							function time(o) {
								if(wait == 0) {
									document.getElementById("codebtn").style.backgroundColor = "rgb(47,164,234)";
									document.getElementById("codebtn").disabled = false;
									o.innerHTML = "获取验证码";
									wait = 60;
								} else {
									document.getElementById("codebtn").style.backgroundColor = "#999";
									document.getElementById("codebtn").disabled = true;
									o.innerHTML = "(" + wait + ")" + "秒";
									wait--;
									setTimeout(function() {
										time(o);
									}, 1000);
								}
							}
							// 倒计时读秒
							if(!document.getElementById("codebtn").disabled) {
								time(document.getElementById("codebtn"));
							}
							mui.ajax('${pageContext.request.contextPath}/sendCode', {
								data: {
									phone: phone //手机号
								},
								dataType: 'json', //服务器返回json格式数据
								type: 'post', //HTTP请求类型
								success: function(data) {
									//服务器返回响应，根据响应结果，分析是否登录成功；
									if("false" == data.result) {
										document.getElementById("codebtn").disabled = false;
										document.getElementById("codebtn").innerHTML = "获取验证码";
										document.getElementById("codebtn").removeAttribute("disabled");
										wait = 0;
										return;
									}
								},
								error: function(xhr, type, errorThrown) {
									//异常处理；
									console.log(type);
								}
							});
						}
					})
				}
				var result = $('#Idexpirydate')[0];
				var btns = $('#zzyouxiaoqi');
				btns.each(function(i, btn) {
					btn.addEventListener('tap', function() {
						var optionsJson = this.getAttribute('data-options') || '{}';
						var options = JSON.parse(optionsJson);

						//if(options.starttoday === 1) {
						var endDate = "2099-11-31"
						var endDateArray = endDate.split('-');
						end = new Date();
						options.beginDate = new Date(end.valueOf() + 1 * 24 * 60 * 60 * 1000); //明天
						options.endDate = new Date(parseInt(endDateArray[0]), parseInt(endDateArray[1]), parseInt(endDateArray[2]));
						//}
						var picker = new $.DtPicker(options);
						picker.show(function(rs) {
							var youxiaoqi = rs.y.text + rs.m.text + rs.d.text;
							result.value = youxiaoqi;
							picker.dispose();
						});

					}, false);
				});
				var results = $('#Identitycarddate')[0];
				var btnss = $('#fryouxiaoqi');
				btnss.each(function(i, btn) {
					btn.addEventListener('tap', function() {
						var optionsJsons = this.getAttribute('data-options') || '{}';
						var optionss = JSON.parse(optionsJsons);

						//if(options.starttoday === 1) {
						var endDates = "2099-11-31"
						var endDateArrays = endDates.split('-');
						ends = new Date();
						optionss.beginDate = new Date(ends.valueOf() + 1 * 24 * 60 * 60 * 1000); //明天
						optionss.endDate = new Date(parseInt(endDateArrays[0]), parseInt(endDateArrays[1]), parseInt(endDateArrays[2]));
						//}
						var pickers = new $.DtPicker(optionss);
						pickers.show(function(rs) {
							var youxiaoqis = rs.y.text + rs.m.text + rs.d.text;
							results.value = youxiaoqis;
							pickers.dispose();
						});

					}, false);
				});
				var _getParam = function(obj, param) {
					return obj[param] || '';
				};
				//行业联示例
				var hangyePicker = new $.PopPicker({
					layer: 3
				});

				hangyePicker.setData(hangyeData3);
				var showhangyePickerButton = doc.getElementById('hangyeResult');
				var hangyeResult = doc.getElementById('hangyeResult');
				showhangyePickerButton.addEventListener('tap', function(event) {
					hangyePicker.show(function(items) {
						hangyeResult.value = _getParam(items[0], 'text') + " - " + _getParam(items[1], 'text') + " - " + _getParam(items[2], 'text');
						$("#IndustrySonType")[0].value = _getParam(items[2], 'value');
					});
				}, false);
				//-----------------------------------------
				//地区级联示例
				var cityPicker = new $.PopPicker({
					layer: 3
				});
				var cityjson = '${citylist}';
				var cityData = eval('(' + cityjson + ')')
				cityPicker.setData(cityData);
				var showCityPickerButton = doc.getElementById('cityResult');
				var cityResult = doc.getElementById('cityResult');
				showCityPickerButton.addEventListener('tap', function(event) {
					cityPicker.show(function(items) {
						cityResult.value = _getParam(items[0], 'text') + " - " + _getParam(items[1], 'text') + " - " + _getParam(items[2], 'text');
						$("#provinceID")[0].value = _getParam(items[0], 'text');
						$("#cityID")[0].value = _getParam(items[1], 'text');
						$("#districtID")[0].value = _getParam(items[2], 'text');
					});
				}, false);
				//-----------------------------------------

				//提交
				document.getElementById("Submit").addEventListener('click', function() {
					var check = true;
					var isId = new RegExp("^[1-9]\\d{5}(18|19|([23]\\d))\\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\\d{3}[0-9Xx]$");
					var ShopName = $("#ShopName")[0].value; //商户名称
					if(ShopName.trim() == "") {
						mui.alert("商户名称不允许为空");
						check = false;
						return false;
					} else {
						var isMe = new RegExp("^([a-z]|[A-Z]|[0-9]|[\\u4e00-\\u9fa5]){0,20}$");
						if(!isMe.test(ShopName)) {
							mui.alert("商户名称不能含有特殊符号且长度为20");
							check = false;
							return false;
						} else {
							$("#BusinessLicenseName")[0].value = ShopName;
						}
					}
					var idtype = $("input[name='idtype']:checked")[0].value; //证件类型
					var BusinessLicenseName = $("#BusinessLicenseName")[0].value;
					if(idtype == "B") {
						if(BusinessLicenseName.trim() == "") {
							mui.alert("营业执照名称不允许为空");
							check = false;
							return false;
						}
					} else {
						var isMe = new RegExp("^([a-z]|[A-Z]|[0-9]|[\\u4e00-\\u9fa5]){0,50}$");
						if(!isMe.test(BusinessLicenseName)) {
							mui.alert("营业名称不能含有特殊符号且长度为50");
							check = false;
							return false;
						}
					}
					if(idtype == "B") {
						var Idnumber = $("#Idnumber")[0].value; //证件号码
						if(Idnumber.trim() == "") {
							mui.alert("证号码不允许为空");
							check = false;
							return false;
						}
						/* else if(idtype=="A"){
														if(!isId.test(Idnumber)){
															mui.alert("身份证号码错误");check = false;return false;
														}
													} */
						else if(idtype == "B") {
							var isID = new RegExp("^([0-9]|[A-Z]){0,20}$");
							if(!isID.test(Idnumber)) {
								mui.alert("证件号码错误");
								check = false;
								return false;
							}
						}
						/* else{
														$("#Idnumber")[0].value=$("#Identitycard")[0].value;
													} */
					}
					if(idtype == "B") {
						var Idexpirydate = $("#Idexpirydate")[0].value; //证件到期日
						if(Idexpirydate.trim() == "") {
							mui.alert("证件到期日不允许为空");
							check = false;
							return false;
						}
					}
					var Identitycard = $("#Identitycard")[0].value; //法人身份证号
					if(Identitycard.trim() == "") {
						mui.alert("法人身份证号码不允许为空");
						check = false;
						return false;
					} else {
						if(!isId.test(Identitycard)) {
							mui.alert("法人身份证号码长度有误或者含有特殊符号");
							check = false;
							return false;
						}
					}
					var Identitycarddate = $("#Identitycarddate")[0].value; //法人身份证到期日
					if(Identitycarddate.trim() == "") {
						mui.alert("法人身份证到期日不允许为空");
						check = false;
						return false;
					}
					//验证个人入账的时候给证件类型和日期赋值
					if(idtype == "A") {
						var abc = $("#Identitycard")[0].value;
						$("#Idnumber")[0].value = abc;
						var zxcv = $("#Identitycarddate")[0].value;
						$("#Idexpirydate")[0].value = zxcv;
					}
					var Contactname = $("#Contactname")[0].value; //联系人姓名
					if(Contactname.trim() == "") {
						mui.alert("联系人姓名不允许为空");
						check = false;
						return false;
					} else {
						var isCo = new RegExp("^([a-z]|[A-Z]|[0-9]|[\\u4e00-\\u9fa5]){0,15}$");
						if(!isCo.test(Contactname)) {
							mui.alert("联系人姓名不能含有特殊符号");
							check = false;
							return false;
						}
					}
					/* var Servicetel = $("#Servicetel")[0].value; //客服电话
					if(Servicetel.trim() == "") {
						mui.alert("客服电话不允许为空");check = false;return false;
					}else{
						var isPhone =new RegExp("^[1][3,4,5,6,7,8][0-9]{9}$");
					    var isMob= new RegExp("^([0,4]\\d{2,3}-|[0,4]\\d{2,3})(\\d{7,8}|\\d{3}-\\d{4})$");
					    if(!isMob.test(Servicetel)&&!isPhone.test(Servicetel)){
					    	mui.alert("客服电话输入有误");check = false;return false;
					    }
					} */
					var contacttel = $("#contacttel")[0].value; //联系电话
					if(contacttel.trim() == "") {
						mui.alert("联系电话不允许为空");
						check = false;
						return false;
					} else {
						var reg = /^1[3|4|5|6|7|8][0-9]{9}$/;
						if(!reg.test(contacttel)) {
							mui.alert("联系电话无效，请重新输入");
							check = false;
							return false;
						}
					}
					var Source = $("#Source")[0].value;
					if(Source == "1") {
						var verificationCode = $("#verificationCode")[0].value; //验证码
						if(verificationCode == '' || verificationCode == undefined) {
							layer.msg('请输入验证码');
							return;
						}
					}
					/* var Contactemail = $("#Contactemail")[0].value; //联系邮箱
					if(Contactemail.trim() == "") {
						mui.alert("联系邮箱不允许为空");check = false;return false;
					}else{
						var reg = new RegExp("^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$");
						if(!reg.test(Contactemail)){
							mui.alert("联系邮箱无效，请重新输入");check = false;return false;
						}
					} */
					var hangyeResult = $("#hangyeResult")[0].value; //经营范围
					if(hangyeResult.trim() == "") {
						mui.alert("经营范围不允许为空");
						check = false;
						return false;
					}
					var cityResult = $("#cityResult")[0].value; //商户所在地
					if(cityResult.trim() == "") {
						mui.alert("商户所在地不允许为空");
						check = false;
						return false;
					}
					var detailedaddress = $("#detailedaddress")[0].value; //商户所在详细地址
					if(detailedaddress.trim() == "") {
						mui.alert("商户所在详细地址不允许为空");
						check = false;
						return false;
					}
					var wx_busi_flag = "1"; //是否开启绿洲
					mui.toast("请稍等...");
					mask.show(); //显示遮罩
					if(Source == "1") {
						check && mui.ajax('${pageContext.request.contextPath}/yancode', {
							data: {
								phone: contacttel,
								verificationCode: verificationCode
							},
							dataType: 'json', //服务器返回json格式数据
							type: 'post', //HTTP请求类型
							success: function(data1) {
								if("success" == data1.result) {
									check && mui.ajax('${pageContext.request.contextPath}/merchantAdd2', {
										data: {
											QRCodeNumber: $("#QRCodeNumber")[0].value, //二维码
											UserNumber: $("#UserNumber")[0].value,
											ShopNumber: $("#ShopNumber")[0].value,
											ShopName: $("#ShopName")[0].value, //商户名称
											BusinessLicenseName: $("#BusinessLicenseName")[0].value,
											License_type: idtype,
											Idnumber: $("#Idnumber")[0].value, //证件号码
											Idexpirydate: $("#Idexpirydate")[0].value, //证件到期日
											Identitycard: $("#Identitycard")[0].value, //法人身份证号
											Identitycarddate: $("#Identitycarddate")[0].value, //法人身份证到期日
											Contactname: $("#Contactname")[0].value, //联系人姓名
											Servicetel: $("#contacttel")[0].value, //客服电话
											contacttel: $("#contacttel")[0].value, //联系电话
											Contactemail: "97104421@qq.com", //$("#Contactemail")[0].value, //联系邮箱
											hangyeResult: $("#hangyeResult")[0].value, //经营范围
											detailedaddress: $("#detailedaddress")[0].value, //商户所在详细地址
											Wx_busi_flag: wx_busi_flag, //是否开启绿洲
											IndustrySonType: $("#IndustrySonType")[0].value, //经营范围代码
											provinceID: $("#provinceID")[0].value, //省代码
											cityID: $("#cityID")[0].value, //市代码
											districtID: $("#districtID")[0].value, //区代码
											cityResult: $("#cityResult")[0].value,
										},
										dataType: 'json', //服务器返回json格式数据
										type: 'post', //HTTP请求类型
										success: function(data2) {
											//关闭遮罩蒙板
											flag = true;
											mask.close();
											//服务器返回响应，根据响应结果，分析是否登录成功；
											if("success" == data2.result) {
												window.location.href = '${pageContext.request.contextPath}/salesingup/gobankCardAdd?QRCodeNumber=' + $("#QRCodeNumber")[0].value + '&UserNumber=' + data2.UserNumber + '&ShopNumber=' + data2.ShopNumber;
											} else {
												mui.alert(data2.msg);
												return;
											}
										},
										error: function(xhr, type, errorThrown) {
											//关闭遮罩蒙板
											flag = true;
											mask.close();
											//异常处理；
											console.log(type);
										}
									});
								} else {
									//关闭遮罩蒙板
									flag = true;
									mask.close();
									mui.alert(data1.msg);
									return;
								}

							},
							error: function(xhr, type, errorThrown) {
								//关闭遮罩蒙板
								flag = true;
								mask.close();
								//异常处理；
								console.log(type);
							}
						})
					} else {
						check && mui.ajax('${pageContext.request.contextPath}/merchantAdd2', {
							data: {
								QRCodeNumber: $("#QRCodeNumber")[0].value, //二维码
								UserNumber: $("#UserNumber")[0].value,
								ShopNumber: $("#ShopNumber")[0].value,
								ShopName: $("#ShopName")[0].value, //商户名称
								BusinessLicenseName: $("#BusinessLicenseName")[0].value,
								License_type: idtype,
								Idnumber: $("#Idnumber")[0].value, //证件号码
								Idexpirydate: $("#Idexpirydate")[0].value, //证件到期日
								Identitycard: $("#Identitycard")[0].value, //法人身份证号
								Identitycarddate: $("#Identitycarddate")[0].value, //法人身份证到期日
								Contactname: $("#Contactname")[0].value, //联系人姓名
								Servicetel: $("#contacttel")[0].value, //客服电话
								contacttel: $("#contacttel")[0].value, //联系电话
								Contactemail: "97104421@qq.com", //$("#Contactemail")[0].value, //联系邮箱
								hangyeResult: $("#hangyeResult")[0].value, //经营范围
								detailedaddress: $("#detailedaddress")[0].value, //商户所在详细地址
								Wx_busi_flag: wx_busi_flag, //是否开启绿洲
								IndustrySonType: $("#IndustrySonType")[0].value, //经营范围代码
								provinceID: $("#provinceID")[0].value, //省代码
								cityID: $("#cityID")[0].value, //市代码
								districtID: $("#districtID")[0].value, //区代码
								cityResult: $("#cityResult")[0].value,
							},
							dataType: 'json', //服务器返回json格式数据
							type: 'post', //HTTP请求类型
							success: function(data) {
								//关闭遮罩蒙板
								flag = true;
								mask.close();
								//服务器返回响应，根据响应结果，分析是否登录成功；
								if("success" == data.result) {
									window.location.href = '${pageContext.request.contextPath}/salesingup/gobankCardAdd?QRCodeNumber=' + $("#QRCodeNumber")[0].value + '&UserNumber=' + data.UserNumber + '&ShopNumber=' + data.ShopNumber;
								} else {
									mui.alert(data.msg);
									return;
								}
							},
							error: function(xhr, type, errorThrown) {
								//异常处理；
								console.log(type);
							}
						});
					}
				})
			});
		})(mui, document);
	</script>

</html>